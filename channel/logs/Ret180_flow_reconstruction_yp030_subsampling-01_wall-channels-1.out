2021-02-06 12:48:55.072981: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-06 12:49:00.885964: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-06 12:49:00.956073: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:00.957025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-06 12:49:00.957058: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-06 12:49:00.959409: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-06 12:49:00.961209: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-06 12:49:00.961558: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-06 12:49:00.963876: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-06 12:49:00.965092: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-06 12:49:00.970236: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-06 12:49:00.970462: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:00.971442: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:00.972324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-06 12:49:01.103473: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499980000 Hz
2021-02-06 12:49:01.104689: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4d4b2e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-06 12:49:01.104721: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-06 12:49:01.257198: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:01.264498: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4db7720 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-06 12:49:01.264550: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-06 12:49:01.264804: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:01.265710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-06 12:49:01.265752: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-06 12:49:01.265788: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-06 12:49:01.265822: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-06 12:49:01.265844: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-06 12:49:01.265865: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-06 12:49:01.265886: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-06 12:49:01.265907: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-06 12:49:01.265970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:01.266858: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:01.267684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-06 12:49:01.267723: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-06 12:49:02.205563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-06 12:49:02.205617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-06 12:49:02.205630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-06 12:49:02.205871: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:02.206865: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-06 12:49:02.207706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 1, 192, 192)]     0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 192, 192)     3328      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 192, 192)     512       
_________________________________________________________________
predic_03 (MaxPooling2D)     (None, 128, 96, 96)       0         
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 96, 96)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 96, 96)       1024      
_________________________________________________________________
predic_06 (MaxPooling2D)     (None, 256, 48, 48)       0         
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 48, 48)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 48, 48)       1024      
_________________________________________________________________
predic_09 (MaxPooling2D)     (None, 256, 24, 24)       0         
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 24, 24)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 24, 24)       2048      
_________________________________________________________________
predic_12 (MaxPooling2D)     (None, 512, 12, 12)       0         
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,730,176
Trainable params: 4,726,848
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-06 12:49:21.343850: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1985 of 4200
2021-02-06 12:49:31.374602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 4086 of 4200
2021-02-06 12:49:31.876041: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-06 12:49:33.427118: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-06 12:49:38.446804: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-06 12:53:04.795162: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 2001 of 4200
2021-02-06 12:53:14.736549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 4085 of 4200
2021-02-06 12:53:15.278978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0030, loss: 6.700240135192871, val_loss: 2.227592706680298, elapsed time from start: 281.12945199012756
Epoch 0002/0030, loss: 0.9777610301971436, val_loss: 0.32425349950790405, elapsed time from start: 511.9576609134674
Epoch 0003/0030, loss: 0.1541741043329239, val_loss: 0.06566057354211807, elapsed time from start: 742.5847902297974
Epoch 0004/0030, loss: 0.04162858426570892, val_loss: 0.03020758554339409, elapsed time from start: 969.5446717739105
Epoch 0005/0030, loss: 0.024048272520303726, val_loss: 0.022762157022953033, elapsed time from start: 1204.8903188705444
Epoch 0006/0030, loss: 0.021144529804587364, val_loss: 0.021190764382481575, elapsed time from start: 1449.5757410526276
Epoch 0007/0030, loss: 0.02050921320915222, val_loss: 0.02085879258811474, elapsed time from start: 1693.481294631958
Epoch 0008/0030, loss: 0.02023191563785076, val_loss: 0.020671149715781212, elapsed time from start: 1936.1215226650238
Epoch 0009/0030, loss: 0.020062146708369255, val_loss: 0.020878946408629417, elapsed time from start: 2182.5314066410065
Epoch 0010/0030, loss: 0.01992667093873024, val_loss: 0.020714540034532547, elapsed time from start: 2426.1451885700226
Epoch 0011/0030, loss: 0.019818464294075966, val_loss: 0.020282065495848656, elapsed time from start: 2669.1672599315643
Epoch 0012/0030, loss: 0.01965256780385971, val_loss: 0.02128506824374199, elapsed time from start: 2913.672609567642
Epoch 0013/0030, loss: 0.019503004848957062, val_loss: 0.020399758592247963, elapsed time from start: 3157.1534082889557
Epoch 0014/0030, loss: 0.01937580481171608, val_loss: 0.019847147166728973, elapsed time from start: 3402.5606610774994
Epoch 0015/0030, loss: 0.01926698535680771, val_loss: 0.01981866918504238, elapsed time from start: 3646.272547721863
Epoch 0016/0030, loss: 0.019169513136148453, val_loss: 0.01971300132572651, elapsed time from start: 3893.155104637146
Epoch 0017/0030, loss: 0.019086066633462906, val_loss: 0.019735168665647507, elapsed time from start: 4139.197971582413
Epoch 0018/0030, loss: 0.01900949701666832, val_loss: 0.019576188176870346, elapsed time from start: 4385.011199951172
Epoch 0019/0030, loss: 0.018932953476905823, val_loss: 0.019503306597471237, elapsed time from start: 4629.692031621933
Epoch 0020/0030, loss: 0.018867069855332375, val_loss: 0.019435793161392212, elapsed time from start: 4874.41209602356
Epoch 0021/0030, loss: 0.018809383735060692, val_loss: 0.01933782733976841, elapsed time from start: 5119.072036027908
Epoch 0022/0030, loss: 0.01875237748026848, val_loss: 0.019291048869490623, elapsed time from start: 5365.243769407272
Epoch 0023/0030, loss: 0.018703296780586243, val_loss: 0.01934916526079178, elapsed time from start: 5611.684119224548
Epoch 0024/0030, loss: 0.018654773011803627, val_loss: 0.019407950341701508, elapsed time from start: 5858.408382177353
Epoch 0025/0030, loss: 0.0186122115701437, val_loss: 0.019257573410868645, elapsed time from start: 6104.885357379913
Epoch 0026/0030, loss: 0.018570730462670326, val_loss: 0.01919751800596714, elapsed time from start: 6352.271955490112
Epoch 0027/0030, loss: 0.018532760441303253, val_loss: 0.019136017188429832, elapsed time from start: 6597.528186559677
Epoch 0028/0030, loss: 0.01849994622170925, val_loss: 0.019072245806455612, elapsed time from start: 6843.319101810455
Epoch 0029/0030, loss: 0.01846691407263279, val_loss: 0.019075965508818626, elapsed time from start: 7089.344611406326
Epoch 0030/0030, loss: 0.018438488245010376, val_loss: 0.019039789214730263, elapsed time from start: 7335.256734609604
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-06 14:51:27.403961: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
