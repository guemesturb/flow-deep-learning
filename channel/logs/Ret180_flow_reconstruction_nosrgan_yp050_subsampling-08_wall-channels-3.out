2021-02-17 00:17:02.238470: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:17:06.983347: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-17 00:17:07.960058: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:07.962417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 00:17:07.962477: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:17:07.966137: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 00:17:07.968781: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 00:17:07.969342: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 00:17:07.972719: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 00:17:07.974633: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 00:17:07.981654: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 00:17:07.981854: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:08.054731: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:08.106780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-17 00:17:08.247836: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-17 00:17:08.249625: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x427de10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-17 00:17:08.249662: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-17 00:17:08.370834: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:08.371789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x42ea260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-17 00:17:08.371824: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-17 00:17:08.372062: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:08.372841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 00:17:08.372886: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:17:08.372925: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 00:17:08.372965: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 00:17:08.372991: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 00:17:08.373015: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 00:17:08.373039: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 00:17:08.373064: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 00:17:08.373136: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:08.373936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:08.375452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-17 00:17:08.375549: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:17:10.621727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-17 00:17:10.621810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-17 00:17:10.621826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-17 00:17:10.622148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:10.623022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:17:10.623816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 24, 24)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 24, 24)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 24, 24)       512       
_________________________________________________________________
predic_03 (MaxPooling2D)     (None, 128, 12, 12)       0         
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-17 00:17:31.617903: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1986 of 4200
2021-02-17 00:17:41.521618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 4052 of 4200
2021-02-17 00:17:42.333538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 00:17:44.063210: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 00:17:47.969894: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 00:20:58.552106: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1986 of 4200
2021-02-17 00:21:08.544112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 4061 of 4200
2021-02-17 00:21:09.242348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0020, loss: 6.71232795715332, val_loss: 2.219428062438965, elapsed time from start: 260.95122361183167
2021-02-17 00:23:46.491908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3223 of 4200
2021-02-17 00:23:49.856369: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0002/0020, loss: 0.9733266830444336, val_loss: 0.32223567366600037, elapsed time from start: 420.6243357658386
Epoch 0003/0020, loss: 0.15491773188114166, val_loss: 0.06753125041723251, elapsed time from start: 525.0899777412415
Epoch 0004/0020, loss: 0.0446697399020195, val_loss: 0.03319517895579338, elapsed time from start: 628.1705369949341
Epoch 0005/0020, loss: 0.028981193900108337, val_loss: 0.027808522805571556, elapsed time from start: 734.0136125087738
Epoch 0006/0020, loss: 0.026470236480236053, val_loss: 0.02717522159218788, elapsed time from start: 838.669842004776
Epoch 0007/0020, loss: 0.026000380516052246, val_loss: 0.027074992656707764, elapsed time from start: 942.4630300998688
Epoch 0008/0020, loss: 0.025823287665843964, val_loss: 0.02730068936944008, elapsed time from start: 1047.9762485027313
Epoch 0009/0020, loss: 0.025712566450238228, val_loss: 0.02716599777340889, elapsed time from start: 1151.498573064804
Epoch 0010/0020, loss: 0.025624675676226616, val_loss: 0.02714444510638714, elapsed time from start: 1255.066987991333
Epoch 0011/0020, loss: 0.02554500289261341, val_loss: 0.02725878544151783, elapsed time from start: 1360.4223175048828
Epoch 0012/0020, loss: 0.025423958897590637, val_loss: 0.027165966108441353, elapsed time from start: 1464.0519466400146
Epoch 0013/0020, loss: 0.025287188589572906, val_loss: 0.02716982178390026, elapsed time from start: 1569.2190570831299
Epoch 0014/0020, loss: 0.025162585079669952, val_loss: 0.02717386558651924, elapsed time from start: 1671.9702892303467
Epoch 0015/0020, loss: 0.02505367435514927, val_loss: 0.027136918157339096, elapsed time from start: 1775.4142711162567
Epoch 0016/0020, loss: 0.024934258311986923, val_loss: 0.027231089770793915, elapsed time from start: 1879.9379816055298
Epoch 0017/0020, loss: 0.024836810305714607, val_loss: 0.027279380708932877, elapsed time from start: 1982.4321329593658
Epoch 0018/0020, loss: 0.02473198063671589, val_loss: 0.02728601172566414, elapsed time from start: 2086.303384542465
Epoch 0019/0020, loss: 0.024632541462779045, val_loss: 0.027303753420710564, elapsed time from start: 2191.3306975364685
Epoch 0020/0020, loss: 0.024536021053791046, val_loss: 0.027286622673273087, elapsed time from start: 2295.590271949768
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-17 00:55:38.310869: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
