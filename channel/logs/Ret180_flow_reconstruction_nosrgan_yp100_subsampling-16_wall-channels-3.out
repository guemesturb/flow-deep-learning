2021-02-17 14:00:58.457550: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 14:01:03.582831: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-17 14:01:04.391962: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.392903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 14:01:04.392948: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 14:01:04.395185: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 14:01:04.396820: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 14:01:04.397178: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 14:01:04.399226: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 14:01:04.400423: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 14:01:04.405165: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 14:01:04.405362: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.406307: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.407102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-17 14:01:04.566445: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-17 14:01:04.568791: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x42e9120 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-17 14:01:04.568830: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-17 14:01:04.698092: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.699114: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4355570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-17 14:01:04.699143: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-17 14:01:04.699330: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.700167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 14:01:04.700203: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 14:01:04.700233: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 14:01:04.700267: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 14:01:04.700287: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 14:01:04.700306: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 14:01:04.700325: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 14:01:04.700344: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 14:01:04.700407: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.701265: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:04.702118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-17 14:01:04.702158: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 14:01:05.629317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-17 14:01:05.629409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-17 14:01:05.629423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-17 14:01:05.630142: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:05.631338: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 14:01:05.632248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 12, 12)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 12, 12)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 12, 12)       512       
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-17 14:01:27.431301: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1860 of 4200
2021-02-17 14:01:37.379496: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3755 of 4200
2021-02-17 14:01:39.690041: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 14:01:41.326471: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 14:01:44.034916: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 14:05:33.258068: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1987 of 4200
2021-02-17 14:05:43.221452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 4059 of 4200
2021-02-17 14:05:43.930081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0020, loss: 6.701615810394287, val_loss: 2.2075819969177246, elapsed time from start: 301.0080358982086
2021-02-17 14:06:28.043771: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3259 of 4200
2021-02-17 14:06:30.213436: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 14:09:40.788935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1651 of 4200
2021-02-17 14:09:50.792462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3235 of 4200
2021-02-17 14:09:56.835571: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0002/0020, loss: 0.9622105360031128, val_loss: 0.3120110034942627, elapsed time from start: 554.7596197128296
Epoch 0003/0020, loss: 0.1458301693201065, val_loss: 0.05906574800610542, elapsed time from start: 649.5853562355042
Epoch 0004/0020, loss: 0.03697296977043152, val_loss: 0.025648092851042747, elapsed time from start: 744.6378710269928
Epoch 0005/0020, loss: 0.022227954119443893, val_loss: 0.020635010674595833, elapsed time from start: 838.2491111755371
Epoch 0006/0020, loss: 0.02012486942112446, val_loss: 0.020068079233169556, elapsed time from start: 932.3740944862366
Epoch 0007/0020, loss: 0.019843626767396927, val_loss: 0.020027391612529755, elapsed time from start: 1028.3107960224152
Epoch 0008/0020, loss: 0.019791550934314728, val_loss: 0.020038463175296783, elapsed time from start: 1125.7984380722046
Epoch 0009/0020, loss: 0.019780820235610008, val_loss: 0.020058313384652138, elapsed time from start: 1223.9147589206696
Epoch 0010/0020, loss: 0.019765790551900864, val_loss: 0.02007574588060379, elapsed time from start: 1321.021301984787
Epoch 0011/0020, loss: 0.01976187340915203, val_loss: 0.02007264643907547, elapsed time from start: 1419.215752363205
Epoch 0012/0020, loss: 0.019742662087082863, val_loss: 0.020097766071558, elapsed time from start: 1513.0508172512054
Epoch 0013/0020, loss: 0.019722890108823776, val_loss: 0.02011057175695896, elapsed time from start: 1608.3480079174042
Epoch 0014/0020, loss: 0.01970091462135315, val_loss: 0.0201664250344038, elapsed time from start: 1703.3620150089264
Epoch 0015/0020, loss: 0.019682524725794792, val_loss: 0.020211949944496155, elapsed time from start: 1798.3190159797668
Epoch 0016/0020, loss: 0.019649647176265717, val_loss: 0.02023644745349884, elapsed time from start: 1896.4006776809692
Epoch 0017/0020, loss: 0.019632697105407715, val_loss: 0.020309526473283768, elapsed time from start: 1991.8056235313416
Epoch 0018/0020, loss: 0.01960844174027443, val_loss: 0.02031511440873146, elapsed time from start: 2088.711349964142
Epoch 0019/0020, loss: 0.019576141610741615, val_loss: 0.0203632190823555, elapsed time from start: 2182.419838666916
Epoch 0020/0020, loss: 0.019541854038834572, val_loss: 0.020413685590028763, elapsed time from start: 2278.4669630527496
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-17 14:39:17.376359: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
