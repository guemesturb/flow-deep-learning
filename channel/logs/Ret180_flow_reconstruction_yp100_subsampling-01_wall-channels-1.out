2021-02-04 14:58:37.543955: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-04 14:58:42.826846: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-04 14:58:43.115735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.117961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-04 14:58:43.118019: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-04 14:58:43.120238: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-04 14:58:43.121963: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-04 14:58:43.122305: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-04 14:58:43.124406: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-04 14:58:43.125617: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-04 14:58:43.130498: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-04 14:58:43.130653: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.139481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.217695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-04 14:58:43.378038: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2500020000 Hz
2021-02-04 14:58:43.381492: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x47d67b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-04 14:58:43.381584: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-04 14:58:43.506692: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.507726: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4842c00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-04 14:58:43.507827: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-04 14:58:43.508269: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.509604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-04 14:58:43.509659: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-04 14:58:43.509702: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-04 14:58:43.509753: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-04 14:58:43.509786: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-04 14:58:43.509818: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-04 14:58:43.509850: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-04 14:58:43.509882: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-04 14:58:43.509987: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.511396: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:43.513051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-04 14:58:43.513137: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-04 14:58:45.440583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-04 14:58:45.440663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-04 14:58:45.440679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-04 14:58:45.441230: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:45.442198: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-04 14:58:45.443143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 1, 192, 192)]     0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 192, 192)     3328      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 192, 192)     512       
_________________________________________________________________
predic_03 (MaxPooling2D)     (None, 128, 96, 96)       0         
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 96, 96)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 96, 96)       1024      
_________________________________________________________________
predic_06 (MaxPooling2D)     (None, 256, 48, 48)       0         
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 48, 48)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 48, 48)       1024      
_________________________________________________________________
predic_09 (MaxPooling2D)     (None, 256, 24, 24)       0         
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 24, 24)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 24, 24)       2048      
_________________________________________________________________
predic_12 (MaxPooling2D)     (None, 512, 12, 12)       0         
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,730,176
Trainable params: 4,726,848
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-04 14:59:03.315216: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3096 of 4200
2021-02-04 14:59:05.690311: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-04 14:59:07.191286: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-04 14:59:11.932712: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
Epoch 0001/0030, loss: 6.675063610076904, val_loss: 2.2087583541870117, elapsed time from start: 267.8145823478699
Epoch 0002/0030, loss: 0.9624277949333191, val_loss: 0.31177252531051636, elapsed time from start: 519.0102980136871
Epoch 0003/0030, loss: 0.1454562097787857, val_loss: 0.05867511034011841, elapsed time from start: 755.745034456253
Epoch 0004/0030, loss: 0.03638966754078865, val_loss: 0.024816548451781273, elapsed time from start: 993.4686009883881
Epoch 0005/0030, loss: 0.02097463794052601, val_loss: 0.019340399652719498, elapsed time from start: 1229.50066781044
Epoch 0006/0030, loss: 0.018742652609944344, val_loss: 0.018789062276482582, elapsed time from start: 1463.2293195724487
Epoch 0007/0030, loss: 0.018399065360426903, val_loss: 0.018814971670508385, elapsed time from start: 1700.8156669139862
Epoch 0008/0030, loss: 0.018300073221325874, val_loss: 0.0189446322619915, elapsed time from start: 1938.8481011390686
Epoch 0009/0030, loss: 0.018252672627568245, val_loss: 0.01894906908273697, elapsed time from start: 2178.0087661743164
Epoch 0010/0030, loss: 0.018219707533717155, val_loss: 0.0190715529024601, elapsed time from start: 2415.1912088394165
Epoch 0011/0030, loss: 0.01818998157978058, val_loss: 0.019131716340780258, elapsed time from start: 2651.4526171684265
Epoch 0012/0030, loss: 0.018132900819182396, val_loss: 0.01914737932384014, elapsed time from start: 2887.773252248764
Epoch 0013/0030, loss: 0.018060140311717987, val_loss: 0.019216537475585938, elapsed time from start: 3122.8443636894226
Epoch 0014/0030, loss: 0.017988799139857292, val_loss: 0.019252531230449677, elapsed time from start: 3358.9643137454987
Epoch 0015/0030, loss: 0.017917674034833908, val_loss: 0.019351107999682426, elapsed time from start: 3595.9236216545105
Epoch 0016/0030, loss: 0.017843104898929596, val_loss: 0.019384760409593582, elapsed time from start: 3833.056114435196
Epoch 0017/0030, loss: 0.017777228727936745, val_loss: 0.019496360793709755, elapsed time from start: 4069.719445705414
Epoch 0018/0030, loss: 0.01770271360874176, val_loss: 0.019527826458215714, elapsed time from start: 4306.277875185013
Epoch 0019/0030, loss: 0.017628110945224762, val_loss: 0.019564315676689148, elapsed time from start: 4543.875446796417
Epoch 0020/0030, loss: 0.01755138486623764, val_loss: 0.019585616886615753, elapsed time from start: 4780.463027000427
Epoch 0021/0030, loss: 0.017478017136454582, val_loss: 0.019673287868499756, elapsed time from start: 5018.476843833923
Epoch 0022/0030, loss: 0.017411166802048683, val_loss: 0.01997964270412922, elapsed time from start: 5256.396235466003
Epoch 0023/0030, loss: 0.017337927594780922, val_loss: 0.019799932837486267, elapsed time from start: 5493.7736077308655
Epoch 0024/0030, loss: 0.01726081594824791, val_loss: 0.019853714853525162, elapsed time from start: 5732.415100097656
Epoch 0025/0030, loss: 0.01720331236720085, val_loss: 0.019905783236026764, elapsed time from start: 5971.652266263962
Epoch 0026/0030, loss: 0.017133664339780807, val_loss: 0.0199577733874321, elapsed time from start: 6206.715745449066
Epoch 0027/0030, loss: 0.017068184912204742, val_loss: 0.01993269845843315, elapsed time from start: 6440.859224319458
Epoch 0028/0030, loss: 0.01700911857187748, val_loss: 0.019993826746940613, elapsed time from start: 6670.207128286362
Epoch 0029/0030, loss: 0.01694667525589466, val_loss: 0.020031843334436417, elapsed time from start: 6899.08297085762
Epoch 0030/0030, loss: 0.0168966855853796, val_loss: 0.020082583650946617, elapsed time from start: 7127.987337112427
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-04 16:57:48.864993: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
