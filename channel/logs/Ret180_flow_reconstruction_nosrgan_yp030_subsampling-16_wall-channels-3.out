2021-02-17 13:19:26.236764: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 13:19:32.432526: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-17 13:19:33.553295: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:33.562932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 13:19:33.562979: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 13:19:33.612997: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 13:19:33.658315: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 13:19:33.676673: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 13:19:33.741975: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 13:19:33.754091: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 13:19:33.797996: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 13:19:33.798254: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:33.799532: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:33.800661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-17 13:19:34.000787: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-17 13:19:34.003029: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5550110 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-17 13:19:34.003068: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-17 13:19:34.127195: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:34.128244: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bc560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-17 13:19:34.128277: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-17 13:19:34.128506: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:34.129385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 13:19:34.129432: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 13:19:34.129477: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 13:19:34.129517: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 13:19:34.129542: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 13:19:34.129566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 13:19:34.129589: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 13:19:34.129613: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 13:19:34.129686: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:34.130601: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:34.131447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-17 13:19:34.131495: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 13:19:35.470943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-17 13:19:35.471040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-17 13:19:35.471059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-17 13:19:35.471658: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:35.472775: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 13:19:35.473837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 12, 12)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 12, 12)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 12, 12)       512       
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-17 13:19:57.313173: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1736 of 4200
2021-02-17 13:20:07.236615: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3698 of 4200
2021-02-17 13:20:09.673169: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 13:20:11.388869: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 13:20:15.190572: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 13:23:37.467094: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1596 of 4200
2021-02-17 13:23:47.500918: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3416 of 4200
2021-02-17 13:23:51.579174: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0020, loss: 6.730808258056641, val_loss: 2.2306485176086426, elapsed time from start: 280.78486227989197
2021-02-17 13:24:37.549818: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3484 of 4200
2021-02-17 13:24:38.915300: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 13:27:38.523291: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 2065 of 4200
2021-02-17 13:27:48.205983: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0002/0020, loss: 0.9844031929969788, val_loss: 0.333318293094635, elapsed time from start: 514.9537177085876
Epoch 0003/0020, loss: 0.16597267985343933, val_loss: 0.0785452127456665, elapsed time from start: 609.075540304184
Epoch 0004/0020, loss: 0.05577564612030983, val_loss: 0.04447966814041138, elapsed time from start: 700.6106793880463
Epoch 0005/0020, loss: 0.04036543145775795, val_loss: 0.038843970745801926, elapsed time from start: 793.4181628227234
Epoch 0006/0020, loss: 0.037776485085487366, val_loss: 0.03818806633353233, elapsed time from start: 887.2886962890625
Epoch 0007/0020, loss: 0.03741230443120003, val_loss: 0.038207460194826126, elapsed time from start: 981.4504811763763
Epoch 0008/0020, loss: 0.03731667250394821, val_loss: 0.03822747617959976, elapsed time from start: 1075.946299791336
Epoch 0009/0020, loss: 0.037283167243003845, val_loss: 0.03831315413117409, elapsed time from start: 1169.7961461544037
Epoch 0010/0020, loss: 0.037251319736242294, val_loss: 0.038326311856508255, elapsed time from start: 1264.4802491664886
Epoch 0011/0020, loss: 0.03722686320543289, val_loss: 0.038404010236263275, elapsed time from start: 1358.4196231365204
Epoch 0012/0020, loss: 0.037152159959077835, val_loss: 0.0383235402405262, elapsed time from start: 1453.0692727565765
Epoch 0013/0020, loss: 0.03706488758325577, val_loss: 0.038493648171424866, elapsed time from start: 1547.4502291679382
Epoch 0014/0020, loss: 0.036979373544454575, val_loss: 0.03849998861551285, elapsed time from start: 1641.8311157226562
Epoch 0015/0020, loss: 0.036902859807014465, val_loss: 0.03846658766269684, elapsed time from start: 1736.9427688121796
Epoch 0016/0020, loss: 0.03680393099784851, val_loss: 0.038569893687963486, elapsed time from start: 1831.9785046577454
Epoch 0017/0020, loss: 0.03673285245895386, val_loss: 0.038693949580192566, elapsed time from start: 1925.7807121276855
Epoch 0018/0020, loss: 0.03664318472146988, val_loss: 0.03881222382187843, elapsed time from start: 2019.9607362747192
Epoch 0019/0020, loss: 0.03654767945408821, val_loss: 0.0388183519244194, elapsed time from start: 2115.1607961654663
Epoch 0020/0020, loss: 0.03644409403204918, val_loss: 0.03891855105757713, elapsed time from start: 2209.778335094452
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-17 13:56:40.642901: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
