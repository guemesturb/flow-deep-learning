2021-02-17 15:29:13.016407: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 15:30:00.818852: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-17 15:30:02.780228: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:02.783531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 15:30:02.783587: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 15:30:02.786961: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 15:30:02.789458: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 15:30:02.790016: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 15:30:02.792948: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 15:30:02.794737: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 15:30:02.831896: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 15:30:02.832111: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:02.917901: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:02.919006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-17 15:30:03.062759: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-17 15:30:03.065441: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x467ce10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-17 15:30:03.065493: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-17 15:30:03.225322: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:03.226560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x46e9260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-17 15:30:03.226626: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-17 15:30:03.226971: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:03.227783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 15:30:03.227828: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 15:30:03.227867: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 15:30:03.227908: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 15:30:03.227934: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 15:30:03.227958: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 15:30:03.227982: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 15:30:03.228007: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 15:30:03.228080: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:03.228879: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:03.229622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-17 15:30:03.229671: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 15:30:05.194330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-17 15:30:05.194416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-17 15:30:05.194429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-17 15:30:05.194909: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:05.195653: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 15:30:05.196326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 48, 48)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 48, 48)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 48, 48)       512       
_________________________________________________________________
predic_03 (MaxPooling2D)     (None, 128, 24, 24)       0         
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 24, 24)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 24, 24)       1024      
_________________________________________________________________
predic_06 (MaxPooling2D)     (None, 256, 12, 12)       0         
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-17 15:30:26.911871: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1723 of 4200
2021-02-17 15:30:36.921646: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3802 of 4200
2021-02-17 15:30:38.797019: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 15:30:40.753571: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 15:30:44.714219: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 15:33:59.442856: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1834 of 4200
2021-02-17 15:34:09.449806: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3938 of 4200
2021-02-17 15:34:10.737486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0020, loss: 6.704813003540039, val_loss: 2.208766460418701, elapsed time from start: 268.0464189052582
2021-02-17 15:37:00.527081: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 2499 of 4200
2021-02-17 15:37:07.240992: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0002/0020, loss: 0.9626380801200867, val_loss: 0.3118739724159241, elapsed time from start: 440.0299777984619
Epoch 0003/0020, loss: 0.14517533779144287, val_loss: 0.057856012135744095, elapsed time from start: 543.3959128856659
Epoch 0004/0020, loss: 0.035283163189888, val_loss: 0.02364412508904934, elapsed time from start: 645.3924341201782
Epoch 0005/0020, loss: 0.01997974142432213, val_loss: 0.01874198392033577, elapsed time from start: 744.9702682495117
Epoch 0006/0020, loss: 0.017687566578388214, val_loss: 0.01822509802877903, elapsed time from start: 850.8011786937714
Epoch 0007/0020, loss: 0.017307301983237267, val_loss: 0.018269486725330353, elapsed time from start: 953.8938019275665
Epoch 0008/0020, loss: 0.01717020943760872, val_loss: 0.018521592020988464, elapsed time from start: 1055.5810911655426
Epoch 0009/0020, loss: 0.017077913507819176, val_loss: 0.018610714003443718, elapsed time from start: 1156.738114118576
Epoch 0010/0020, loss: 0.016994498670101166, val_loss: 0.01879592053592205, elapsed time from start: 1262.873416185379
Epoch 0011/0020, loss: 0.016930148005485535, val_loss: 0.018885722383856773, elapsed time from start: 1367.8845210075378
Epoch 0012/0020, loss: 0.016830189153552055, val_loss: 0.018904533237218857, elapsed time from start: 1473.1307458877563
Epoch 0013/0020, loss: 0.01670587994158268, val_loss: 0.01898988150060177, elapsed time from start: 1576.512694120407
Epoch 0014/0020, loss: 0.016604023054242134, val_loss: 0.019127212464809418, elapsed time from start: 1673.9674956798553
Epoch 0015/0020, loss: 0.016509342938661575, val_loss: 0.019069379195570946, elapsed time from start: 1771.5200490951538
Epoch 0016/0020, loss: 0.01640550047159195, val_loss: 0.01919570378959179, elapsed time from start: 1867.0507657527924
Epoch 0017/0020, loss: 0.01632544957101345, val_loss: 0.01925620064139366, elapsed time from start: 1965.0781025886536
Epoch 0018/0020, loss: 0.016228970140218735, val_loss: 0.019293125718832016, elapsed time from start: 2063.1740045547485
Epoch 0019/0020, loss: 0.016148174181580544, val_loss: 0.019317984580993652, elapsed time from start: 2160.8532683849335
Epoch 0020/0020, loss: 0.016065938398241997, val_loss: 0.0193528700619936, elapsed time from start: 2259.160325050354
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-17 16:07:57.379192: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
