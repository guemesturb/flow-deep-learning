2021-02-16 22:33:27.066703: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 22:33:28.323488: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-16 22:33:28.514696: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.516537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-16 22:33:28.516583: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 22:33:28.519129: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-16 22:33:28.521143: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-16 22:33:28.521527: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-16 22:33:28.524060: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-16 22:33:28.525401: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-16 22:33:28.530919: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-16 22:33:28.531076: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.619000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.619666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-16 22:33:28.728580: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-16 22:33:28.729942: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4b70e10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-16 22:33:28.729979: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-16 22:33:28.836596: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.837431: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4bdd260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-16 22:33:28.837462: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-16 22:33:28.837670: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.838360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-16 22:33:28.838401: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 22:33:28.838435: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-16 22:33:28.838471: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-16 22:33:28.838493: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-16 22:33:28.838514: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-16 22:33:28.838535: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-16 22:33:28.838557: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-16 22:33:28.838621: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.839313: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:28.839957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-16 22:33:28.840001: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 22:33:30.813785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-16 22:33:30.813860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-16 22:33:30.813879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-16 22:33:30.815307: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:30.818529: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 22:33:30.820803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 12, 12)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 12, 12)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 12, 12)       512       
_________________________________________________________________
predic_04 (Conv2D)           (None, 128, 12, 12)       147584    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 128, 12, 12)       512       
_________________________________________________________________
predic_07 (Conv2D)           (None, 128, 12, 12)       147584    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 128, 12, 12)       512       
_________________________________________________________________
predic_10 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_13 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        147520    
=================================================================
Total params: 1,341,248
Trainable params: 1,339,456
Non-trainable params: 1,792
_________________________________________________________________
None
2021-02-16 22:33:44.665205: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-16 22:33:49.882324: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
Epoch 0001/0010, loss: 3.67305588722229, val_loss: 1.223386287689209, elapsed time from start: 96.8237657546997
Epoch 0002/0010, loss: 0.5543099641799927, val_loss: 0.20317809283733368, elapsed time from start: 180.79850387573242
Epoch 0003/0010, loss: 0.11192776262760162, val_loss: 0.06393194943666458, elapsed time from start: 264.4790713787079
Epoch 0004/0010, loss: 0.05109002813696861, val_loss: 0.04498116299510002, elapsed time from start: 350.65145897865295
Epoch 0005/0010, loss: 0.04181738197803497, val_loss: 0.04064224660396576, elapsed time from start: 434.73236417770386
Epoch 0006/0010, loss: 0.03986889496445656, val_loss: 0.04025688394904137, elapsed time from start: 519.518431186676
Epoch 0007/0010, loss: 0.039600670337677, val_loss: 0.04027002677321434, elapsed time from start: 607.5215764045715
Epoch 0008/0010, loss: 0.039521925151348114, val_loss: 0.040218718349933624, elapsed time from start: 691.2480385303497
Epoch 0009/0010, loss: 0.03948793560266495, val_loss: 0.04042186588048935, elapsed time from start: 776.273588180542
Epoch 0010/0010, loss: 0.03946046158671379, val_loss: 0.04029471427202225, elapsed time from start: 863.7449014186859
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-16 22:48:05.852656: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
