2021-02-17 12:33:50.317067: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 12:33:57.098287: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-17 12:33:57.744447: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:57.746297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 12:33:57.746344: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 12:33:57.789926: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 12:33:57.834602: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 12:33:57.853266: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 12:33:57.895851: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 12:33:57.905592: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 12:33:57.948198: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 12:33:57.948386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:57.949213: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:57.949951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-17 12:33:58.154008: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-17 12:33:58.155909: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4f9d1f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-17 12:33:58.155950: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-17 12:33:58.298628: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:58.299652: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5009600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-17 12:33:58.299686: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-17 12:33:58.299908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:58.300784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 12:33:58.300827: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 12:33:58.300860: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 12:33:58.300898: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 12:33:58.300922: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 12:33:58.300945: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 12:33:58.300968: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 12:33:58.300991: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 12:33:58.301067: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:58.301989: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:58.302840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-17 12:33:58.302885: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 12:33:59.754868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-17 12:33:59.754947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-17 12:33:59.754961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-17 12:33:59.755506: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:59.756478: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 12:33:59.757375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 24, 24)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 24, 24)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 24, 24)       512       
_________________________________________________________________
predic_03 (MaxPooling2D)     (None, 128, 12, 12)       0         
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-17 12:34:21.445538: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1883 of 4200
2021-02-17 12:34:31.453052: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3939 of 4200
2021-02-17 12:34:32.790549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 12:34:34.615830: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 12:34:38.301123: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 12:38:08.826207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1836 of 4200
2021-02-17 12:38:18.807144: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3951 of 4200
2021-02-17 12:38:20.051344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0020, loss: 6.729644298553467, val_loss: 2.227968454360962, elapsed time from start: 282.9799630641937
2021-02-17 12:41:29.073065: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1860 of 4200
2021-02-17 12:41:39.043315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3682 of 4200
2021-02-17 12:41:41.591155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0002/0020, loss: 0.9810078144073486, val_loss: 0.32882142066955566, elapsed time from start: 485.5878701210022
Epoch 0003/0020, loss: 0.16054105758666992, val_loss: 0.07236259430646896, elapsed time from start: 580.751188993454
Epoch 0004/0020, loss: 0.04872848838567734, val_loss: 0.0369780957698822, elapsed time from start: 674.7978467941284
Epoch 0005/0020, loss: 0.032000552862882614, val_loss: 0.03051326423883438, elapsed time from start: 768.5250492095947
Epoch 0006/0020, loss: 0.02887628972530365, val_loss: 0.029498551040887833, elapsed time from start: 864.5630762577057
Epoch 0007/0020, loss: 0.028231145814061165, val_loss: 0.02923518605530262, elapsed time from start: 958.299525976181
Epoch 0008/0020, loss: 0.027943165972828865, val_loss: 0.029105128720402718, elapsed time from start: 1052.7607417106628
Epoch 0009/0020, loss: 0.027758844196796417, val_loss: 0.028984684497117996, elapsed time from start: 1147.4605746269226
Epoch 0010/0020, loss: 0.02760687842965126, val_loss: 0.02892550826072693, elapsed time from start: 1242.8817238807678
Epoch 0011/0020, loss: 0.02748202718794346, val_loss: 0.028820637613534927, elapsed time from start: 1338.1800484657288
Epoch 0012/0020, loss: 0.027290955185890198, val_loss: 0.028764482587575912, elapsed time from start: 1433.6357908248901
Epoch 0013/0020, loss: 0.0270994920283556, val_loss: 0.028604721650481224, elapsed time from start: 1530.4862015247345
Epoch 0014/0020, loss: 0.026935365051031113, val_loss: 0.02855646423995495, elapsed time from start: 1625.9225692749023
Epoch 0015/0020, loss: 0.026787733659148216, val_loss: 0.02843295782804489, elapsed time from start: 1720.1472826004028
Epoch 0016/0020, loss: 0.026639217510819435, val_loss: 0.028354180976748466, elapsed time from start: 1814.6982803344727
Epoch 0017/0020, loss: 0.026524458080530167, val_loss: 0.028314687311649323, elapsed time from start: 1910.7835867404938
Epoch 0018/0020, loss: 0.026402071118354797, val_loss: 0.02827570214867592, elapsed time from start: 2005.3209047317505
Epoch 0019/0020, loss: 0.026288246735930443, val_loss: 0.028204696252942085, elapsed time from start: 2099.7301366329193
Epoch 0020/0020, loss: 0.026180142536759377, val_loss: 0.028185559436678886, elapsed time from start: 2196.748166322708
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-17 13:10:50.178550: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
