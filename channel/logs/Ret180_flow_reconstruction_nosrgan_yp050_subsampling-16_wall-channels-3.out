2021-02-17 00:59:40.312213: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:59:44.789313: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-17 00:59:46.611201: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.613848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 00:59:46.613896: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:59:46.616929: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 00:59:46.619377: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 00:59:46.619875: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 00:59:46.622939: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 00:59:46.624584: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 00:59:46.631129: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 00:59:46.631321: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.734107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.734877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-17 00:59:46.857615: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-17 00:59:46.860750: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4e1c120 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-17 00:59:46.860802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-17 00:59:46.986330: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.987274: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4e88570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-17 00:59:46.987311: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-17 00:59:46.987576: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.988354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-17 00:59:46.988395: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:59:46.988427: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 00:59:46.988463: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-17 00:59:46.988487: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-17 00:59:46.988509: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-17 00:59:46.988530: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-17 00:59:46.988553: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 00:59:46.988624: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.989421: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:46.990294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-17 00:59:46.990395: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-17 00:59:49.109747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-17 00:59:49.109826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-17 00:59:49.109841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-17 00:59:49.110141: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:49.111002: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-17 00:59:49.111791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 12, 12)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 12, 12)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 12, 12)       512       
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-17 01:00:11.101136: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1755 of 4200
2021-02-17 01:00:21.148737: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3906 of 4200
2021-02-17 01:00:22.638533: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
2021-02-17 01:00:25.125992: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-17 01:00:28.931888: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-17 01:03:38.681647: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 1738 of 4200
2021-02-17 01:03:48.816618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:172] Filling up shuffle buffer (this may take a while): 3906 of 4200
2021-02-17 01:03:50.254110: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:221] Shuffle buffer filled.
Epoch 0001/0020, loss: 6.723898887634277, val_loss: 2.2207822799682617, elapsed time from start: 262.6831946372986
Epoch 0002/0020, loss: 0.9745979309082031, val_loss: 0.32384294271469116, elapsed time from start: 403.2930488586426
Epoch 0003/0020, loss: 0.15724453330039978, val_loss: 0.07025691121816635, elapsed time from start: 503.93221950531006
Epoch 0004/0020, loss: 0.047777239233255386, val_loss: 0.03639521449804306, elapsed time from start: 603.8346292972565
Epoch 0005/0020, loss: 0.032547712326049805, val_loss: 0.031051475554704666, elapsed time from start: 702.3775098323822
Epoch 0006/0020, loss: 0.030243631452322006, val_loss: 0.030471166595816612, elapsed time from start: 803.9685192108154
Epoch 0007/0020, loss: 0.029927607625722885, val_loss: 0.030459001660346985, elapsed time from start: 902.9076538085938
Epoch 0008/0020, loss: 0.02984892763197422, val_loss: 0.03047415055334568, elapsed time from start: 1001.2829644680023
Epoch 0009/0020, loss: 0.029829151928424835, val_loss: 0.03048032335937023, elapsed time from start: 1099.9076516628265
Epoch 0010/0020, loss: 0.02980552241206169, val_loss: 0.030490564182400703, elapsed time from start: 1201.0777716636658
Epoch 0011/0020, loss: 0.02978428453207016, val_loss: 0.030538925901055336, elapsed time from start: 1299.898124217987
Epoch 0012/0020, loss: 0.029745323583483696, val_loss: 0.030536845326423645, elapsed time from start: 1401.144650220871
Epoch 0013/0020, loss: 0.029693113639950752, val_loss: 0.03056005761027336, elapsed time from start: 1501.8109786510468
Epoch 0014/0020, loss: 0.02965432032942772, val_loss: 0.030617568641901016, elapsed time from start: 1603.2448086738586
Epoch 0015/0020, loss: 0.02960563823580742, val_loss: 0.030639424920082092, elapsed time from start: 1701.775921344757
Epoch 0016/0020, loss: 0.029545465484261513, val_loss: 0.03073602169752121, elapsed time from start: 1801.8552649021149
Epoch 0017/0020, loss: 0.029502229765057564, val_loss: 0.030780747532844543, elapsed time from start: 1901.8119683265686
Epoch 0018/0020, loss: 0.02945335954427719, val_loss: 0.030876662582159042, elapsed time from start: 2003.3549225330353
Epoch 0019/0020, loss: 0.02939523756504059, val_loss: 0.030871564522385597, elapsed time from start: 2103.6962716579437
Epoch 0020/0020, loss: 0.029330864548683167, val_loss: 0.031059540808200836, elapsed time from start: 2204.88645029068
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-17 01:36:47.103298: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
