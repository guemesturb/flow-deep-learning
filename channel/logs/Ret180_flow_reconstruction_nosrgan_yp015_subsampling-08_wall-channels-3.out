2021-02-16 23:23:50.956869: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 23:23:56.651007: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-02-16 23:23:58.456971: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.459192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-16 23:23:58.459246: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 23:23:58.462616: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-16 23:23:58.465079: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-16 23:23:58.465592: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-16 23:23:58.468759: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-16 23:23:58.470552: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-16 23:23:58.477396: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-16 23:23:58.477585: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.593207: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.594001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
Using TensorFlow version:  2.3.0 , GPU: 1
Using Keras version:  2.4.0
2021-02-16 23:23:58.723057: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2499965000 Hz
2021-02-16 23:23:58.725762: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x449ae10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-16 23:23:58.725798: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-16 23:23:58.857216: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.858181: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4507260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-16 23:23:58.858215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-02-16 23:23:58.858455: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.859231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:04:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-02-16 23:23:58.859275: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 23:23:58.859312: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-02-16 23:23:58.859351: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-02-16 23:23:58.859377: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-02-16 23:23:58.859401: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-02-16 23:23:58.859425: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-02-16 23:23:58.859450: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-16 23:23:58.859523: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.860320: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:23:58.861061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-02-16 23:23:58.861112: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-02-16 23:24:01.194183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-16 23:24:01.194292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-02-16 23:24:01.194313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-02-16 23:24:01.195023: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:24:01.196264: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-02-16 23:24:01.197402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10068 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5)
The inputs are normalized to have a unit Gaussian distribution
Model: "CNN-POD"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
high-res-input (InputLayer)  [(None, 3, 24, 24)]       0         
_________________________________________________________________
predic_01 (Conv2D)           (None, 128, 24, 24)       9728      
_________________________________________________________________
predic_02 (BatchNormalizatio (None, 128, 24, 24)       512       
_________________________________________________________________
predic_03 (MaxPooling2D)     (None, 128, 12, 12)       0         
_________________________________________________________________
predic_04 (Conv2D)           (None, 256, 12, 12)       295168    
_________________________________________________________________
predic_05 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_07 (Conv2D)           (None, 256, 12, 12)       590080    
_________________________________________________________________
predic_08 (BatchNormalizatio (None, 256, 12, 12)       1024      
_________________________________________________________________
predic_10 (Conv2D)           (None, 512, 12, 12)       1180160   
_________________________________________________________________
predic_11 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_13 (Conv2D)           (None, 512, 12, 12)       2359808   
_________________________________________________________________
predic_14 (BatchNormalizatio (None, 512, 12, 12)       2048      
_________________________________________________________________
predic_15 (Conv2D)           (None, 64, 12, 12)        294976    
=================================================================
Total params: 4,736,576
Trainable params: 4,733,248
Non-trainable params: 3,328
_________________________________________________________________
None
2021-02-16 23:24:16.457080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-02-16 23:24:20.336137: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
Epoch 0001/0020, loss: 6.733088970184326, val_loss: 2.231914520263672, elapsed time from start: 110.84966111183167
Epoch 0002/0020, loss: 0.9831128120422363, val_loss: 0.32912135124206543, elapsed time from start: 212.8298318386078
Epoch 0003/0020, loss: 0.15883859992027283, val_loss: 0.06913360953330994, elapsed time from start: 313.98384308815
Epoch 0004/0020, loss: 0.04498330131173134, val_loss: 0.032825447618961334, elapsed time from start: 414.37794041633606
Epoch 0005/0020, loss: 0.02739560790359974, val_loss: 0.025240760296583176, elapsed time from start: 517.6596162319183
Epoch 0006/0020, loss: 0.023954637348651886, val_loss: 0.024058019742369652, elapsed time from start: 620.3022935390472
Epoch 0007/0020, loss: 0.023259401321411133, val_loss: 0.02407318539917469, elapsed time from start: 723.1664361953735
Epoch 0008/0020, loss: 0.02293042093515396, val_loss: 0.023604800924658775, elapsed time from start: 825.4701454639435
Epoch 0009/0020, loss: 0.022715633735060692, val_loss: 0.023495418950915337, elapsed time from start: 930.010055065155
Epoch 0010/0020, loss: 0.022555900737643242, val_loss: 0.023421553894877434, elapsed time from start: 1034.7479147911072
Epoch 0011/0020, loss: 0.02241116389632225, val_loss: 0.023326335474848747, elapsed time from start: 1137.821949481964
Epoch 0012/0020, loss: 0.022202713415026665, val_loss: 0.023025479167699814, elapsed time from start: 1240.3509168624878
Epoch 0013/0020, loss: 0.022009773179888725, val_loss: 0.022843899205327034, elapsed time from start: 1342.3979284763336
Epoch 0014/0020, loss: 0.02184286341071129, val_loss: 0.022797882556915283, elapsed time from start: 1447.2540278434753
Epoch 0015/0020, loss: 0.02169697917997837, val_loss: 0.022679541260004044, elapsed time from start: 1552.4463918209076
Epoch 0016/0020, loss: 0.021567584946751595, val_loss: 0.022513408213853836, elapsed time from start: 1657.7104387283325
Epoch 0017/0020, loss: 0.02144518867135048, val_loss: 0.022388070821762085, elapsed time from start: 1761.7795605659485
Epoch 0018/0020, loss: 0.021339796483516693, val_loss: 0.0223291777074337, elapsed time from start: 1864.7060861587524
Epoch 0019/0020, loss: 0.021237382665276527, val_loss: 0.022235462442040443, elapsed time from start: 1969.560524225235
Epoch 0020/0020, loss: 0.021143218502402306, val_loss: 0.02218865416944027, elapsed time from start: 2073.833800315857
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-16 23:58:47.334249: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/alejandro/projects/urban-flows/.env/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
